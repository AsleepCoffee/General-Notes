# Protect virtual machines with JIT VM access

Brute-force login attacks commonly target management ports as a means to gain access to a virtual machine or server. If successful, an attacker can take control of the host and establish a foothold into your environment.

Stopping brute-force attacks

To counteract brute-force attacks, you can take multiple measures such as:

    Disabling the public IP address and using one of these connection methods:
        Use a point-to-site virtual private network (VPN)
        Create a site-to-site VPN
        Use Azure ExpressRoute to create secure links from your on-premise network to Azure

    Require two-factor authentication

    Increase password length and complexity

    Limit login attempts

    Implement Captcha

    Limiting the amount of time that the ports are open

This final approach is what Azure Security Center implements on your behalf. Management ports such as Remote Desktop and SSH only need to be open while you are connected to the VM, for example, to perform management or maintenance tasks. In the standard tier, Azure Security Center supports Just-in-time (JIT) virtual machine (VM) access. When just-in-time access is enabled, Security Center uses network security group (NSG) rules to restrict access to management ports when they aren't in use so they cannot be targeted by attackers.
Enabling JIT VM Access

When you enable JIT VM Access for your VMs, you can create a policy that determines the ports to help protect, how long ports should remain open, and the approved IP addresses that can access these ports. The policy enables you to stay in control of what users can do when they request access. Requests are logged in the Azure activity log, so you can easily monitor and audit access. The policy will also help you quickly identify the existing VMs that have JIT VM Access enabled and the VMs where JIT VM Access is recommended.

# Exercise - enabling JIT VM access

https://docs.microsoft.com/en-us/learn/modules/secure-vms-with-azure-security-center/3-exercise-jit-vm-access

# Understand the malware threat

Computer systems that interact directly with users are considered endpoint systems. Systems on devices, such as laptops, smartphones, tablets, and computers, all need to be secured to help prevent them from acting as gateways for security attacks on an organization's networked systems. In today's world of "bring-your-own-devices", that even means protecting personal devices that have access to your business resources.

The news is filled with stories about how organizations have leaked personal information. Often, those accidents were the result of poor security practices or deliberate attacks. Hackers gain access to systems by impersonating a real user, or by somehow inserting malware into a computer or device that has authorized access to the network.
What is malware?

Malware is malicious software intended to cause damage to a computer or network. It often exploits vulnerabilities in software or unsuspecting users who unknowingly install it.

Malware comes in several forms:

Viruses

A computer virus, like a live virus, requires a "host" to live in. Viruses are bits of code that attach to existing programs and documents or hide in protected areas of your hard drive, such as the boot sector, making them hard to find and remove. When the infected program is launched, the virus is executed (often without the user noticing anything) and can perform malicious actions on the user's data or other files. If an infected computer sends a file to another computer, it can spread the virus with the data. This behavior is what classifies a computer virus: it lives inside other programs and requires human interaction to spread.

Some examples of viruses have been: ILOVEYOU, Shamoon, and CIH (Chernobyl virus).

Worms

A worm is a piece of standalone software that copies itself through a computer network. The behavior of a worm is similar to a virus in that it is designed to duplicate itself, but instead of hiding in existing files, a worm is a separate program that can infect other computers without human involvement. A worm often travels over the computer network, running in the background on an infected computer and using known vulnerabilities in computer software to locate and infect other connected devices.

Some examples of worms have been Melissa, Code Red, and Stuxnet.

Trojan Horses

Everyone knows the story of Troy and the wooden horse that was used to invade the city. This malware adopts the same name because it pretends to be something that it's not. Trojan Horses are considered to be the most dangerous type of malware because of what they are often designed to do. They are spread by masquerading as a useful software utility that a user wants to install. Because the user authorizes the install, this malware will often gain access to the user's files - including sensitive or private data. In addition, trojans will often install backdoors to let hackers into the computer, or keyloggers to capture keystrokes such as passwords or credit cards. Unlike the other types of malware, trojan horses aren't generally designed to replicate themselves widely - they are intended specifically to control or destroy specific computers they infect.

Some examples of trojan horses are Gh0st RAT, Zeus, and Shedun (on Android).

How does malware get installed?

There are several ways malware can get onto a computer initially.

    Direct install. Most software is delivered over the Internet today. Users are conditioned to download and install software from a variety of sources. Malware can get installed either without the user's knowledge or through an authorized download that's been tampered with. This approach also applies to infected drives (such as USB keys) being inserted into a computer.

    Security vulnerability. A defect or bug in running software such as a browser, or even the operating system can allow malware to get installed onto the computer. In this case, the malware exploits the security flaw to obtain administrator access, or to get infected files onto the computer.

    Backdoor. Malware can also get installed through a designed opening left in the software. These "backdoors" are often placed there for testing and debugging. If it's left in place and released into production, it can be exploited to gain access to the computer or network.

Protect against malware

There are several key strategies you can use along with Security Center to protect your computers and network from malware.

    Keep your servers up-to-date with the latest OS fixes and versions. Security Center will automatically alert you when monitored systems are unpatched.
    Install antimalware such as Microsoft Antimalware for Azure Cloud Services and Virtual Machines to help identify and remove viruses, spyware, and other malicious software.
    Use Firewalls to block network traffic. Security Center will identify open traffic to your VMs and servers and provide instructions, or even one-click actions, to activate built-in firewall capabilities of Azure.
    Integrate your antimalware solution with Azure Security Center to monitor the status of the antimalware protection.

This last step is crucial to a complete monitoring plan. Security Center highlights issues such as detected threats and insufficient protection, which make your VMs and computers vulnerable to malware threats. By using the information on Endpoint protection issues, you can make a plan to address any identified issues.


# Exercise - configure malware detection 

https://docs.microsoft.com/en-us/learn/modules/secure-vms-with-azure-security-center/5-exercise-configure-endpoint-security





























